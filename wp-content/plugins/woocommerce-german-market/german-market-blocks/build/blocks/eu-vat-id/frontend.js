!function(){"use strict";var e=window.wc.blocksCheckout,t=window.wp.element,a=window.wp.data,n=JSON.parse('{"apiVersion":2,"name":"german-market/eu-vat-id","version":"2.0.0","title":"German Market EU VAT ID Check","category":"german-market","description":"Adds the German Market EU VAT ID Check to the checkout","supports":{"html":false,"align":false,"multiple":false,"reusable":true,"lock":false},"parent":["woocommerce/checkout-fields-block","woocommerce/checkout-totals-block"],"textdomain":"woocommerce-german-market"}');(0,e.registerCheckoutBlock)({metadata:n,component:({cart:n,checkoutExtensionData:r,extensions:o,children:i})=>{const{setValidationErrors:s,clearValidationError:c}=(0,a.useDispatch)("wc/store/validation"),l="german-market-eu-vat-id",{setExtensionData:m}=r;let d="",u="",p=!1,g=!1,k="",_="",v="",h="",b="",E="",w="";o["german-market-store-api-integration"]&&(b=o["german-market-store-api-integration"].vat_id_data.default_value,g=o["german-market-store-api-integration"].vat_id_data.required,p=o["german-market-store-api-integration"].vat_id_data.show,u=o["german-market-store-api-integration"].vat_id_data.label,d=o["german-market-store-api-integration"].vat_id_data.country,v=o["german-market-store-api-integration"].vat_id_data.required_error_if_empty,h=o["german-market-store-api-integration"].vat_id_data.validating,_=o["german-market-store-api-integration"].vat_id_data.last_error,E=o["german-market-store-api-integration"].vat_id_data.is_success,w=o["german-market-store-api-integration"].vat_id_data.last_validated_number,k=_&&""!==_?o["german-market-store-api-integration"].vat_id_data.default_error:""),g&&(u+=" *");const[f,y]=(0,t.useState)(b);let x=!1;E&&w===f&&(x=!0);let N=document.getElementById(l),C=!1;N&&(C=!0,N.parentElement.setAttribute("data-validating-string",h),x&&(N.parentElement.classList.contains("validating")||N.parentElement.classList.add("validation-success")));const A=e=>{m("german-market-eu-vat-id-store-api-integration","billing_vat",e)};(0,t.useEffect)((()=>{y(b),A(b)}),[b]),(0,t.useEffect)((()=>{L()}),[C]);const V=()=>{let e=document.getElementsByClassName("wc-block-components-checkout-place-order-button");Array.prototype.forEach.call(e,(function(e){e.setAttribute("disabled",!0)}))},L=()=>{N&&(N.parentElement.classList.add("validating"),N.parentElement.classList.remove("validation-success")),V(),""!==f&&c(l),(0,e.extensionCartUpdate)({namespace:"german-market-blocks-eu-vat-id",data:{show:p,country:d,vat_number:f}}).then((e=>{(()=>{let e=document.getElementsByClassName("wc-block-components-checkout-place-order-button");Array.prototype.forEach.call(e,(function(e){e.removeAttribute("disabled")}))})(),N&&(N.parentElement.classList.remove("validating"),E=e.extensions["german-market-store-api-integration"].vat_id_data.is_success,w=e.extensions["german-market-store-api-integration"].vat_id_data.last_validated_number,E&&w===f&&(x=!0),x&&N.parentElement.classList.add("validation-success")),_=e.extensions["german-market-store-api-integration"].vat_id_data.last_error,k=_&&""!==_?e.extensions["german-market-store-api-integration"].vat_id_data.default_error:"",""!==k&&s({[l]:{message:k,hidden:!1}})}))};(0,t.useEffect)((()=>{L(),p||A("")}),[p,d]);(0,t.useEffect)((()=>{""===k?""!==k||g||c(l):s({[l]:{message:k,hidden:!1}})}),[k,s,c]);let B=(0,t.createElement)(t.Fragment,null);return p&&(B=(0,t.createElement)(t.Fragment,null,(0,t.createElement)("fieldset",{className:"wc-block-checkout__shipping-option wp-block-woocommerce-checkout-shipping-methods-block wc-block-components-checkout-step wc-block-components-checkout-step--with-step-number"},(0,t.createElement)("legend",{className:"screen-reader-text"},u),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__heading"},(0,t.createElement)("h2",{className:"wc-block-components-title wc-block-components-checkout-step__title","aria-hidden":"true"},u)),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__container"},(0,t.createElement)("div",{className:"wc-block-components-checkout-step__content"},(0,t.createElement)(e.ValidatedTextInput,{className:"billing_vat german-market-billing-vat-block",id:l,label:u,value:f,required:!1,onChange:e=>{A(e),N&&N.parentElement.classList.remove("validation-success"),y(e)},onBlur:()=>{L()},onFocus:V,errorId:l,customValidation:e=>!g||""!=e.value||(e.setCustomValidity(v),!1)})))))),B}})}();