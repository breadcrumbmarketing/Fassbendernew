jQuery(document).ready(function(){jQuery(".lexoffice-woocomerce-default").click(function(){if(!(jQuery(this).hasClass("lexoffice-woocommerce-x")||jQuery(this).hasClass("lexoffice-woocommerce-error")||jQuery(this).hasClass("lexoffice-woocommerce-yes")))return;var e=jQuery(this).attr("data-order-id");jQuery(this).removeClass("lexoffice-woocommerce-x").removeClass("lexoffice-woocommerce-error dashicons dashicons-no lexoffice-woocommerce-yes").addClass("lexoffice-woocommerce-loader");var o=jQuery(this),r={action:"lexoffice_woocommerce_edit_shop_order",security:lexoffice_ajax.nonce,order_id:e};let c=e,i=jQuery(this).closest("tr"),s=jQuery(i).children(":not(.hidden)").length;if(jQuery(this).attr("data-refund-id")){var t=jQuery(this).attr("data-refund-id");r.refund_id=t,r.action="lexoffice_woocommerce_edit_shop_order_refund",c=t}jQuery.post(lexoffice_ajax.url,r,function(e){var r=!1;let t=!1,f=!1;if(e.length>=7){var a=e.substring(0,7),d="";"SUCCESS"==a?r=!0:"EXISTS_"===a||"NOTEX_A"===a?(t=!0,a=e.substring(7)):"NOTEX_B"===a&&(f=!0,a=e.substring(7)),e.length>7&&(d=e.substring(7))}if(t){var l='<tr class="error-notice-german-market lexoffice"><td colspan="'+s+'">'+a+"</td></tr>";jQuery(l).insertAfter(i).hide().slideDown("fast"),jQuery(o).removeClass("lexoffice-woocommerce-loader lexoffice-not-completed").addClass("lexoffice-woocommerce-yes dashicons dashicons-yes")}else if(f){var l='<tr class="error-notice-german-market lexoffice"><td colspan="'+s+'">'+a+"</td></tr>";jQuery(l).insertAfter(i).hide().slideDown("fast"),jQuery(o).removeClass("lexoffice-woocommerce-loader lexoffice-not-completed").addClass("lexoffice-woocomerce-default lexoffice-woocommerce-x");var n=jQuery(o).parent().find(".lexoffice-invoice-pdf");jQuery(n).hide(),jQuery("#lexoffice-invoice-number-"+c).html("")}else if(r){jQuery(o).removeClass("lexoffice-woocommerce-loader").addClass("lexoffice-woocommerce-yes dashicons dashicons-yes"),jQuery(o).html("");var n=jQuery(o).parent().find(".lexoffice-invoice-pdf");if(""!=d){jQuery(n).attr("data-document-id",d);var m=jQuery(n).attr("href"),h=m.search("&_wpnonce="),x=m.substring(h),u=m.search("&document_id"),w=m.substring(0,u)+"&document_id="+d+"&order_id="+c+x;jQuery(n).attr("href",w),jQuery(n).show()}else jQuery(n).attr("data-document-id",""),jQuery(n).hide();var v={action:"lexoffice_woocommerce_refresh_invoice_number",security:lexoffice_ajax.nonce,order_id:c};jQuery.post(lexoffice_ajax.url,v,function(e){jQuery("#lexoffice-invoice-number-"+v.order_id).length&&jQuery("#lexoffice-invoice-number-"+v.order_id).html(e)})}else{jQuery(o).html(""),jQuery(o).removeClass("lexoffice-woocommerce-loader lexoffice-not-completed").addClass("lexoffice-woocommerce-error dashicons dashicons-no");var l='<tr class="error-notice-german-market lexoffice"><td colspan="'+s+'">'+e+"</td></tr>";jQuery(l).insertAfter(i).hide().slideDown("fast")}})})});