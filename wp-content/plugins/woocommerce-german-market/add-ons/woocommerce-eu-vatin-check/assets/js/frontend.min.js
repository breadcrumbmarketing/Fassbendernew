!function(i){var e={_valid:!1,init:function(){"always_optional"!=wcvat_script_vars.display_vat_field&&"always_mandatory"!=wcvat_script_vars.display_vat_field&&e.hide_vatin_field(),i("#billing_vat_field").length&&e.ajax_check_vat_field(),i("#billing_country").length&&e.billing_country_handle(),i("#shipping_country").length&&e.shipping_country_handle()},shipping_country_handle:function(){"shipping"==wcvat_script_vars.tax_based_on?(i("#shipping_country").ready(function(){i("#shipping_country").trigger("change")}),i(document).on("change","#ship-to-different-address-checkbox",function(e){i(this).is(":checked")?i("#shipping_country").trigger("change"):i("#billing_country").trigger("change")}),i(document).on("change","#shipping_country",function(e){let l=wcvat_script_vars.display_vat_field;"eu_optional"==l||"eu_mandatory"==l?(wcvat_script_vars.base_country_hide||1==wcvat_script_vars.base_country_hide)&&((wcvat_script_vars.base_country!=i("#shipping_country").val()||wcvat_script_vars.show_for_basecountry_hide_eu_countries)&&""!=i("#shipping_country").val()&&wcvat_script_vars.eu_countries.includes(i("#shipping_country").val())?(i("#billing_vat_field").show(),"eu_mandatory"==l&&(i("#billing_vat_field .optional").hide(),0==i("#billing_vat_field .required").length?i('<abbr class="required required-text" title="'+wcvat_script_vars.required_title_text+'">*</abbr>').insertAfter("#billing_vat_field .optional"):i("#billing_vat_field .required").show()),i("#billing_vat").trigger("blur")):(i("#billing_vat").val("").trigger("blur"),i("#billing_vat_field").hide())):("always_optional"==l||"always_mandatory"==l)&&(i("#billing_vat_field").show(),"always_mandatory"==l&&(i("#billing_vat_field .optional").hide(),0==i("#billing_vat_field .required").length?i('<abbr class="required required-text" title="'+wcvat_script_vars.required_title_text+'">*</abbr>').insertAfter("#billing_vat_field .optional"):i("#billing_vat_field .required").show()),i("#billing_vat").trigger("blur"))})):i("#billing_country").trigger("change")},billing_country_handle:function(){i("#billing_country").ready(function(){i("#billing_country").trigger("change")}),i(document).on("change","#billing_country",function(e){if("billing"==wcvat_script_vars.tax_based_on||"shipping"==wcvat_script_vars.tax_based_on&&i("#ship-to-different-address-checkbox").not(":checked").length||"shipping"==wcvat_script_vars.tax_based_on&&0==i("#ship-to-different-address-checkbox").length){let l=wcvat_script_vars.display_vat_field;"eu_optional"==l||"eu_mandatory"==l?(wcvat_script_vars.base_country_hide||1==wcvat_script_vars.base_country_hide)&&((wcvat_script_vars.base_country!=i("#billing_country").val()||wcvat_script_vars.show_for_basecountry_hide_eu_countries)&&""!=i("#billing_country").val()&&wcvat_script_vars.eu_countries.includes(i("#billing_country").val())?(i("#billing_vat_field").show(),"eu_mandatory"==l&&(i("#billing_vat_field .optional").hide(),0==i("#billing_vat_field .required").length?i('<abbr class="required required-text" title="'+wcvat_script_vars.required_title_text+'">*</abbr>').insertAfter("#billing_vat_field .optional"):i("#billing_vat_field .required").show()),i("#billing_vat").trigger("blur")):(i("#billing_vat").val("").trigger("blur"),i("#billing_vat_field").hide())):("always_optional"==l||"always_mandatory"==l)&&(i("#billing_vat_field").show(),"always_mandatory"==l&&(i("#billing_vat_field .optional").hide(),0==i("#billing_vat_field .required").length?i('<abbr class="required required-text" title="'+wcvat_script_vars.required_title_text+'">*</abbr>').insertAfter("#billing_vat_field .optional"):i("#billing_vat_field .required").show()),i("#billing_vat").trigger("blur"))}})},hide_vatin_field:function(){},ajax_check_vat_field:function(){var l=!1;i("input#billing_vat").ready(function(){""!=i("input#billing_vat").val()&&i("input#billing_vat").trigger("blur")}),i(document).on("blur","input#billing_vat",function(n){let t=wcvat_script_vars.display_vat_field;if(!0===l)return!1;if(""==i(this).val())return i("p.billing_vat").removeClass("woocommerce-validated"),e.clean_up_badges(),!1;l=!0,jQuery("#place_order").length&&jQuery("#place_order").prop("disabled",!0);let a=i(this).val(),r=i(this),o="",d=!1;if(o="shipping"==wcvat_script_vars.tax_based_on&&i("#ship-to-different-address-checkbox").is(":checked")?i("#shipping_country").val():i("#billing_country").val(),!wcvat_script_vars.eu_countries.includes(o))return l=!1,e.clean_up_badges(),jQuery("#place_order").length&&jQuery("#place_order").prop("disabled",!1),!1;"always_mandatory"==t?d=!0:"eu_mandatory"==t&&wcvat_script_vars.base_country!=o&&wcvat_script_vars.eu_countries.includes(o)&&(d=!0),e.clean_up_badges(),r.after(wcvat_script_vars.spinner);var s={action:"wcvat_check_vat",vat:a,country:o,required:d,tax_based_on:wcvat_script_vars.tax_based_on};i.ajax({data:s,url:wcvat_script_vars.ajaxurl,async:!0,dataType:"json"}).always(function(){e.clean_up_badges()}).done(function(l){l&&(!1===l.success?""!=a&&(r.addClass("error"),r.after(wcvat_script_vars.error_badge)):(i(".error-badge").remove(),r.removeClass("error"),r.after(wcvat_script_vars.correct_badge),e._valid=!0))}).always(function(){l=!1,jQuery("#place_order").length&&jQuery("#place_order").prop("disabled",!1)})})},clean_up_badges:function(){i(".error-badge").remove(),i(".spinner-badge").remove(),i(".correct-badge").remove(),i(".spinner-badge").remove()}};i(document).ready(e.init)}(jQuery);